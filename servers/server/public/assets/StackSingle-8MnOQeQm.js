import{n as T,b as j,u as z,S as E}from"./router-dRrCuWpc.js";import V from"./system-lKZWhhFR.js";import{_ as k}from"./_plugin-vue_export-helper-x3n3nnut.js";import{o as c,a as i,e as s,u as L,p as B,d as P,t as U,f as D,v as M,r as m,j as d,i as h,F as $,g as H,k as S,b as x,h as X,z as q}from"./runtime-core.esm-bundler-MKLD6zL_.js";import{a as A,n as N,r as p,t as O}from"./reactivity.esm-bundler-LrxtCAaW.js";import{T as G}from"./Tabs-3f5gQ-aT.js";import{a as J}from"./axios-_p75_7XV.js";import{S as K}from"./index-sqC47xDA.js";import"./vue.runtime.esm-bundler-9Vkzbhtf.js";import"./vue3-markdown-it.umd.min-7JKSWcHD.js";const Q={props:{percent:{default:0}}},W={class:"container"},Y={class:"progress progress-moved"};function Z(o,r,a,e,f,_){return c(),i("span",W,[s("div",Y,[s("div",{class:"progress-bar",style:A({transform:"scaleX("+(a.percent>100?100:a.percent)/100+")"})},null,4)])])}const ee=k(Q,[["render",Z],["__scopeId","data-v-be004152"]]),te={props:{color:{default:"blue"}}},se={class:"card-container"};function ae(o,r,a,e,f,_){return c(),i("div",{class:N(["card-root",a.color])},[s("div",se,[L(o.$slots,"default",{},void 0,!0)])],2)}const oe=k(te,[["render",ae],["__scopeId","data-v-152bf9df"]]),ne=o=>(B("data-v-c97a762b"),o=o(),P(),o),re=ne(()=>s("i",{class:"fas fa-bell","aria-hidden":"true"},null,-1)),ce=[re],ie={__name:"NotificationBell",setup(o){const r=()=>T.openHistory.next();return(a,e)=>(c(),i("div",{class:"notification-bell-root",onClick:r},ce))}},le=k(ie,[["__scopeId","data-v-c97a762b"]]),de={name:"StackSingle",components:{progressCmp:ee,sectionCmp:j,Tabs:G,Card:oe,NotificationBell:le},setup(){const o=z(),r=p([]),a=p(),e=p(0),f=p(0),_=p(!1);U(()=>o.currentRoute.value.params.label,async()=>{await u()}),K.socket.on("conf:update",t=>{t.includes(o.currentRoute.value.params.label.toString())&&u()});let b;const g=p([]);async function u(){if(a.value=await E.getService(o.currentRoute.value.params.label.toString()),a.value){const{data:t}=await J.get("/plugins/services/"+a.value.label);g.value=t.sort((l,n)=>l.order-n.order).map(l=>{var y,C,w,I;const n={label:l.name,id:l.name,icon:l.icon,hidden:l.hidden,warning:0};if(l.name==="Configuration"){const R=Object.keys(((C=(y=a.value)==null?void 0:y.spawnOptions)==null?void 0:C.overrideEnvs)||{});Object.keys(((I=(w=a.value)==null?void 0:w.spawnOptions)==null?void 0:I.env)||{}).some(F=>R.includes(F))&&(n.warning=1)}return n})}}return D(async()=>{await u(),b=setInterval(async()=>{var n;if(!((n=a.value)!=null&&n.label))return;const{cpu:t,mem:l}=await V.getInfos(a.value.label.toString());e.value=t,f.value=l},1e3)}),M(()=>{clearInterval(b)}),{stack:r,System:V,currentService:a,cpu:e,mem:f,tabs:g,restartInProgress:_,async openInVsCode(){var t;(t=a.value)==null||t.openInVsCode()},async openFolder(){var t;(t=a.value)==null||t.openFolder()},async restart(){var t;_.value=!0,await((t=a.value)==null?void 0:t.restart().finally(()=>_.value=!1))},async stop(){var t;await((t=a.value)==null?void 0:t.stop())},async start(){var t;await((t=a.value)==null?void 0:t.start())}}}},v=o=>(B("data-v-6acc6228"),o=o(),P(),o),_e={class:"main"},ue={class:"header"},pe={class:"left"},ve={class:"title"},fe={class:"description"},me={class:"right"},he={class:"icons"},be=["href"],ge=v(()=>s("i",{class:"fab fa-github","aria-hidden":"true"},null,-1)),Se=[ge],ke=["href"],ye=v(()=>s("i",{class:"fas fa-globe","aria-hidden":"true"},null,-1)),Ce=[ye],we=["href","title"],Ie=v(()=>s("i",{class:"fas fa-globe","aria-hidden":"true"},null,-1)),Ve=[Ie],xe={class:"sections"},Oe={key:0,class:"sections"},Be={key:1,class:"system-cards"},Pe=v(()=>s("h2",null,"Memory",-1)),Ne=v(()=>s("h2",null,"CPU",-1)),Re=["disabled"],Fe=v(()=>s("i",{class:"fas fa-stop","aria-hidden":"true"},null,-1)),Te={class:"tab"};function je(o,r,a,e,f,_){const b=m("notification-bell"),g=m("section-cmp"),u=m("progress-cmp"),t=m("card"),l=m("tabs");return e.currentService?(c(),i("div",{class:"stack-single",key:o.$route.params.label.toString()},[s("div",_e,[s("div",ue,[s("div",pe,[s("div",ve,O(e.currentService.label),1),s("div",fe,O(e.currentService.description),1)]),s("div",me,[d(b),s("div",he,[e.currentService.git&&e.currentService.git.home?(c(),i("a",{key:0,href:e.currentService.git.home,target:"_blank",title:"Open git home"},Se,8,be)):h("",!0),e.currentService.url?(c(),i("a",{key:1,href:e.currentService.url,target:"_blank",title:"Open service URL"},Ce,8,ke)):h("",!0),(c(!0),i($,null,H(e.currentService.urls,n=>(c(),i("a",{key:n,href:n,target:"_blank",title:n},Ve,8,we))),128)),e.currentService.rootPath?(c(),i("img",{key:2,src:"https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Visual_Studio_Code_1.35_icon.svg/240px-Visual_Studio_Code_1.35_icon.svg.png",alt:"vscode icon","aria-hidden":"true",title:"Open in Visual Studio Code",onClick:r[0]||(r[0]=n=>e.openInVsCode())})):h("",!0),e.currentService.rootPath?(c(),i("i",{key:3,class:"fas fa-folder","aria-hidden":"true",title:"Open folder",onClick:r[1]||(r[1]=n=>e.openFolder())})):h("",!0)])])]),s("div",xe,[e.currentService.enabled?(c(),i("div",Be,[d(t,{class:"card"},{default:S(()=>[Pe,d(u,{percent:e.mem},null,8,["percent"])]),_:1}),d(t,{class:"card purple"},{default:S(()=>[Ne,d(u,{percent:e.cpu},null,8,["percent"])]),_:1}),d(t,{class:"card orange"},{default:S(()=>[s("button",{onClick:r[2]||(r[2]=n=>e.restart()),disabled:e.restartInProgress},[s("i",{class:N(["fas fa-sync",{rotate:e.restartInProgress}]),"aria-hidden":"true"},null,2),x(" Restart")],8,Re),s("button",{onClick:r[3]||(r[3]=n=>e.stop())},[Fe,x(" Stop")])]),_:1})])):(c(),i("div",Oe,[d(g,{header:"This service is not started",actions:[{label:"Start",click:()=>e.start(),icon:"fas fa-play"}],class:"section-not-started"},null,8,["actions"])])),d(l,{class:"tabs",tabs:e.tabs,showLabels:!1},{default:S(({tab:n})=>[s("div",Te,[(c(),X(q(n.id),{service:e.currentService,key:e.currentService.label},null,8,["service"]))])]),_:1},8,["tabs"])])])])):h("",!0)}const Ge=k(de,[["render",je],["__scopeId","data-v-6acc6228"]]);export{Ge as default};
