import{b as G,u as I,S as r}from"./router-dRrCuWpc.js";import V from"./system-lKZWhhFR.js";import{a as N,v as U,w as F}from"./vue.runtime.esm-bundler-9Vkzbhtf.js";import{B as K,L as M}from"./LeftLogo-wdgTmoHR.js";import{_ as j}from"./_plugin-vue_export-helper-x3n3nnut.js";import{r as S,t as _,c as C}from"./reactivity.esm-bundler-LrxtCAaW.js";import{f as q,c as w,r as k,o as c,a as i,j as A,e as n,h as D,k as R,F as L,g as T,i as g,b as x,w as O,p as z,d as H}from"./runtime-core.esm-bundler-MKLD6zL_.js";import"./index-sqC47xDA.js";import"./vue3-markdown-it.umd.min-7JKSWcHD.js";import"./axios-_p75_7XV.js";const J={name:"StackChooser",components:{sectionCmp:G,BackgroundStackChooser:K,LeftLogo:M},setup(){const d=I(),t=S([]);q(async()=>{await r.loadServices(),t.value=r.services.value.map(l=>{const e=localStorage.getItem(`automatic-toggle-${l.label}`);return{label:l.label,enabled:e==="true"||l.enabled||!1,groups:l.groups}})});const y=async()=>{var e,o;t.value.forEach(s=>{const u=r.services.value.find(h=>h.label===s.label);u&&(u.enabled=s.enabled)}),r.launchServices(r.services.value.filter(s=>s.enabled));const l=await r.getEnabledServices();d.push({name:"stack-single",params:{label:((e=l[0])==null?void 0:e.label)||((o=r.services.value[0])==null?void 0:o.label)}})},a=l=>t.value.filter(e=>{var o;return((o=e.groups)==null?void 0:o.includes(l))||l==="All"}),m=l=>a(l).every(e=>e.enabled),p=S(""),b=async l=>{l!=null&&l.label&&localStorage.setItem(`automatic-toggle-${l.label}`,l.enabled==null?"false":l.enabled.toString())},v=async(l,e=null)=>{l!=null&&(l.enabled=e??!l.enabled,await b(l))};return{servicesToLaunch:t,search:p,isAllEnabled:w(()=>t.value.every(l=>l.enabled)),groups:w(()=>{const l=t.value.reduce((e,o)=>(o.groups&&o.groups.forEach(s=>{e[s]||(e[s]=C({services:[],label:s})),e[s].services.push(o)}),e.All||(e.All=C({services:[],label:"All"})),e.All.services.push(o),e),{});return Object.keys(l).map(e=>l[e]).sort((e,o)=>e.label.localeCompare(o.label))}),toggleGroup(l){const e=m(l);a(l).map(o=>{v(o,!e)})},save:b,isGroupSelected:m,Stack:r,System:V,validate:y,displayedServices(l){return l.filter(e=>{var o;return(o=e.label)==null?void 0:o.toUpperCase().includes(p.value.toUpperCase())})},toggleService:v}}},B=d=>(z("data-v-726cfb37"),d=d(),H(),d),P={class:"stack-chooser-root"},Q={class:"right"},W={class:"groups"},X=["onClick"],Y={class:"left-header"},Z={key:0,class:"fas fa-chevron-down","aria-hidden":"true"},$={class:"right-header"},ee=["onClick"],le={key:0,class:"far fa-check-square","aria-hidden":"true"},ae={key:1,class:"far fa-square","aria-hidden":"true"},se={key:0},oe=["onKeypress"],te=["id","value","checked","onChange"],ne=["for"],ce={class:"actions"},ie=B(()=>n("i",{class:"fas fa-play","aria-hidden":"true"},null,-1)),re={class:"version"},de=B(()=>n("i",{class:"fas fa-toolbox"},null,-1)),ue=[de];function he(d,t,y,a,m,p){const b=k("background-stack-chooser"),v=k("left-logo"),l=k("section-cmp");return c(),i("div",P,[A(b,{lowResources:!0}),A(v),n("div",Q,[a.servicesToLaunch?(c(),D(l,{key:0,class:"stack-chooser",header:"Choose all services to launch"},{default:R(()=>[n("div",W,[(c(!0),i(L,null,T(a.groups,e=>{var o;return c(),i("div",{key:e.label},[n("div",{class:"group-header",onClick:s=>e.show=!e.show},[n("div",Y,[e.label!=="All"?(c(),i("i",Z)):g("",!0),n("h3",null,[x(_(e.label)+" ",1),n("span",null,"("+_((o=e.services)==null?void 0:o.length)+")",1)])]),n("div",$,[n("button",{onClick:N(s=>a.toggleGroup(e.label),["stop"]),class:"mini"},[a.isGroupSelected(e.label)?(c(),i("i",le)):(c(),i("i",ae))],8,ee)])],8,X),e.show||e.label==="All"?(c(),i("ul",se,[O(n("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>a.search=s),onKeypress:F(s=>a.toggleService(a.servicesToLaunch.find(u=>{var h;return u.label===((h=a.displayedServices(e.services)[0])==null?void 0:h.label)})),["enter"]),placeholder:"Type+Enter to toggle..."},null,40,oe),[[U,a.search]]),(c(!0),i(L,null,T(a.displayedServices(e.services),s=>{var u,h;return c(),i("li",{key:"services-"+s.label},[n("input",{type:"checkbox",id:"input-"+s.label,value:(u=a.servicesToLaunch.find(f=>f.label===s.label))==null?void 0:u.enabled,checked:(h=a.servicesToLaunch.find(f=>f.label===s.label))==null?void 0:h.enabled,onChange:f=>a.toggleService(a.servicesToLaunch.find(E=>E.label===s.label))},null,40,te),n("label",{for:"input-"+s.label},_(s.label),9,ne)])}),128))])):g("",!0)])}),128))]),n("div",ce,[a.isAllEnabled?(c(),i("button",{key:1,onClick:t[2]||(t[2]=e=>a.toggleGroup("All"))},"Unselect all")):(c(),i("button",{key:0,onClick:t[1]||(t[1]=e=>a.toggleGroup("All"))},"Select all")),n("button",{onClick:t[3]||(t[3]=(...e)=>a.validate&&a.validate(...e)),class:"success"},[ie,x(" Launch")])])]),_:1})):g("",!0)]),n("div",re,_(a.System.version.value),1),n("div",{class:"tools",onClick:t[4]||(t[4]=e=>d.$router.push({name:"Toolbox"}))},ue)])}const Ce=j(J,[["render",he],["__scopeId","data-v-726cfb37"]]);export{Ce as default};
